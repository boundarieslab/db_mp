<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 25.8.4.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="00:00:00"/>
	<style type="text/css">
		@page { size: 8.27in 11.69in; margin: 0.79in }
		p { margin-bottom: 0.1in; line-height: 115%; background: transparent }
		pre { font-size: 10pt; font-family: "Liberation Mono", monospace; background: transparent }
	</style>
</head>
<body lang="en-US" link="#000080" vlink="#800000" dir="ltr"><pre>&lt;div id=&quot;oras-network&quot; style=&quot;width:100%; height:600px; background:#fff; position: relative; overflow: hidden; border: 1px solid #eee; margin: 0 auto; z-index:10; display:block;&quot;&gt;&lt;svg viewBox=&quot;0 0 669.734375 598&quot; style=&quot;display: block; width: 100%; height: 100%;&quot;&gt;&lt;g&gt;&lt;line stroke=&quot;#ddd&quot; stroke-width=&quot;1&quot; x1=&quot;335.9981074034355&quot; y1=&quot;293.30142365255864&quot; x2=&quot;391.27278551978134&quot; y2=&quot;247.82282932068784&quot;&gt;&lt;/line&gt;&lt;line stroke=&quot;#ddd&quot; stroke-width=&quot;1&quot; x1=&quot;335.9981074034355&quot; y1=&quot;293.30142365255864&quot; x2=&quot;303.3165809501781&quot; y2=&quot;229.61427306923505&quot;&gt;&lt;/line&gt;&lt;line stroke=&quot;#ddd&quot; stroke-width=&quot;1&quot; x1=&quot;335.9981074034355&quot; y1=&quot;293.30142365255864&quot; x2=&quot;394.4565584887976&quot; y2=&quot;335.89060707148053&quot;&gt;&lt;/line&gt;&lt;line stroke=&quot;#ddd&quot; stroke-width=&quot;1&quot; x1=&quot;335.9981074034355&quot; y1=&quot;293.30142365255864&quot; x2=&quot;265.46170011115055&quot; y2=&quot;309.2449974984378&quot;&gt;&lt;/line&gt;&lt;line stroke=&quot;#ddd&quot; stroke-width=&quot;1&quot; x1=&quot;318.40133983322755&quot; y1=&quot;378.5977758607834&quot; x2=&quot;335.9981074034355&quot; y2=&quot;293.30142365255864&quot;&gt;&lt;/line&gt;&lt;/g&gt;&lt;g&gt;&lt;g transform=&quot;translate(391.27278551978134,247.82282932068784)&quot; style=&quot;cursor: pointer;&quot;&gt;&lt;circle r=&quot;25&quot; fill=&quot;transparent&quot;&gt;&lt;/circle&gt;&lt;rect x=&quot;-6&quot; y=&quot;-6&quot; width=&quot;12&quot; height=&quot;12&quot; fill=&quot;#000000&quot; stroke=&quot;#fff&quot; stroke-width=&quot;1&quot;&gt;&lt;/rect&gt;&lt;text x=&quot;12&quot; y=&quot;3&quot; fill=&quot;#999&quot; style=&quot;font: 9px Helvetica, Arial, sans-serif; pointer-events: none;&quot;&gt;Eidsvoll Kommune&lt;/text&gt;&lt;/g&gt;&lt;g transform=&quot;translate(303.3165809501781,229.61427306923505)&quot; style=&quot;cursor: pointer;&quot;&gt;&lt;circle r=&quot;25&quot; fill=&quot;transparent&quot;&gt;&lt;/circle&gt;&lt;rect x=&quot;-6&quot; y=&quot;-6&quot; width=&quot;12&quot; height=&quot;12&quot; fill=&quot;#000000&quot; stroke=&quot;#fff&quot; stroke-width=&quot;1&quot;&gt;&lt;/rect&gt;&lt;text x=&quot;12&quot; y=&quot;3&quot; fill=&quot;#999&quot; style=&quot;font: 9px Helvetica, Arial, sans-serif; pointer-events: none;&quot;&gt;Hurdal Kommune&lt;/text&gt;&lt;/g&gt;&lt;g transform=&quot;translate(394.4565584887976,335.89060707148053)&quot; style=&quot;cursor: pointer;&quot;&gt;&lt;circle r=&quot;25&quot; fill=&quot;transparent&quot;&gt;&lt;/circle&gt;&lt;rect x=&quot;-6&quot; y=&quot;-6&quot; width=&quot;12&quot; height=&quot;12&quot; fill=&quot;#000000&quot; stroke=&quot;#fff&quot; stroke-width=&quot;1&quot;&gt;&lt;/rect&gt;&lt;text x=&quot;12&quot; y=&quot;3&quot; fill=&quot;#999&quot; style=&quot;font: 9px Helvetica, Arial, sans-serif; pointer-events: none;&quot;&gt;Nannestad Kommune&lt;/text&gt;&lt;/g&gt;&lt;g transform=&quot;translate(265.46170011115055,309.2449974984378)&quot; style=&quot;cursor: pointer;&quot;&gt;&lt;circle r=&quot;25&quot; fill=&quot;transparent&quot;&gt;&lt;/circle&gt;&lt;rect x=&quot;-6&quot; y=&quot;-6&quot; width=&quot;12&quot; height=&quot;12&quot; fill=&quot;#000000&quot; stroke=&quot;#fff&quot; stroke-width=&quot;1&quot;&gt;&lt;/rect&gt;&lt;text x=&quot;12&quot; y=&quot;3&quot; fill=&quot;#999&quot; style=&quot;font: 9px Helvetica, Arial, sans-serif; pointer-events: none;&quot;&gt;Ullensaker Kommune&lt;/text&gt;&lt;/g&gt;&lt;g transform=&quot;translate(335.9981074034355,293.30142365255864)&quot; style=&quot;cursor: pointer;&quot;&gt;&lt;circle r=&quot;25&quot; fill=&quot;transparent&quot;&gt;&lt;/circle&gt;&lt;rect x=&quot;-5&quot; y=&quot;-5&quot; width=&quot;10&quot; height=&quot;10&quot; fill=&quot;#3b82f6&quot; stroke=&quot;#fff&quot; stroke-width=&quot;1&quot;&gt;&lt;/rect&gt;&lt;text x=&quot;12&quot; y=&quot;3&quot; fill=&quot;#999&quot; style=&quot;font: 9px Helvetica, Arial, sans-serif; pointer-events: none;&quot;&gt;Øvre Romerike Avfallsselskap IKS (ØRAS)&lt;/text&gt;&lt;/g&gt;&lt;g transform=&quot;translate(318.40133983322755,378.5977758607834)&quot; style=&quot;cursor: pointer;&quot;&gt;&lt;circle r=&quot;18&quot; fill=&quot;transparent&quot; stroke=&quot;#000&quot; stroke-width=&quot;1&quot; stroke-dasharray=&quot;2,2&quot;&gt;&lt;animateTransform attributeName=&quot;transform&quot; type=&quot;rotate&quot; from=&quot;0 0 0&quot; to=&quot;360 0 0&quot; dur=&quot;10s&quot; repeatCount=&quot;indefinite&quot;&gt;&lt;/animateTransform&gt;&lt;/circle&gt;&lt;circle r=&quot;25&quot; fill=&quot;transparent&quot;&gt;&lt;/circle&gt;&lt;polygon points=&quot;0,-6 6,0 0,6 -6,0&quot; transform=&quot;scale(1.5)&quot; fill=&quot;#39ff14&quot; stroke=&quot;#000&quot; stroke-width=&quot;1.5&quot;&gt;&lt;/polygon&gt;&lt;text x=&quot;12&quot; y=&quot;3&quot; fill=&quot;#000&quot; style=&quot;font: bold 10px Helvetica, Arial, sans-serif; pointer-events: none;&quot;&gt;Miljøstasjon Dal Skog&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;

&lt;div style=&quot;display:flex; flex-wrap:wrap; gap:12px; font:9px Helvetica,Arial,sans-serif; color:#000; padding:10px 0; justify-content: center; text-transform: uppercase; letter-spacing: 0.5px; position:relative; z-index:10;&quot;&gt;
    &lt;div style=&quot;display:flex; align-items:center; gap:4px;&quot;&gt;
        &lt;svg height=&quot;10&quot; style=&quot;overflow:visible&quot; width=&quot;10&quot;&gt;&lt;rect fill=&quot;#000&quot; height=&quot;6&quot; transform=&quot;translate(5,5)&quot; width=&quot;6&quot; x=&quot;-3&quot; y=&quot;-3&quot;&gt;&lt;/rect&gt;&lt;/svg&gt;&amp;nbsp;Eierkommune
 &amp;nbsp; &amp;nbsp;&lt;/div&gt;
    &lt;div style=&quot;display:flex; align-items:center; gap:4px;&quot;&gt;
        &lt;svg height=&quot;10&quot; style=&quot;overflow:visible&quot; width=&quot;10&quot;&gt;&lt;rect fill=&quot;#3b82f6&quot; height=&quot;6&quot; transform=&quot;translate(5,5)&quot; width=&quot;6&quot; x=&quot;-3&quot; y=&quot;-3&quot;&gt;&lt;/rect&gt;&lt;/svg&gt;&amp;nbsp;Selskap (IKS)
 &amp;nbsp; &amp;nbsp;&lt;/div&gt;
    &lt;div style=&quot;display:flex; align-items:center; gap:4px;&quot;&gt;
        &lt;svg height=&quot;10&quot; style=&quot;overflow:visible&quot; width=&quot;10&quot;&gt;&lt;polygon fill=&quot;#39ff14&quot; points=&quot;0,-5 5,0 0,5 -5,0&quot; transform=&quot;translate(5,5)&quot;&gt;&lt;/polygon&gt;&lt;/svg&gt;&amp;nbsp;Hovedanlegg
 &amp;nbsp; &amp;nbsp;&lt;/div&gt;
&lt;/div&gt;

&lt;script&gt;
(function(){
 &nbsp; &nbsp;// --- 1. CONFIG ---
 &nbsp; &nbsp;var containerID = &quot;oras-network&quot;; 

&nbsp; &nbsp; var NODES = [
 &nbsp; &nbsp; &nbsp; &nbsp;// OWNERS (Municipalities)
 &nbsp; &nbsp; &nbsp; &nbsp;{id:&quot;Eidsvoll Kommune&quot;, t:&quot;p&quot;},
 &nbsp; &nbsp; &nbsp; &nbsp;{id:&quot;Hurdal Kommune&quot;, t:&quot;p&quot;},
 &nbsp; &nbsp; &nbsp; &nbsp;{id:&quot;Nannestad Kommune&quot;, t:&quot;p&quot;},
 &nbsp; &nbsp; &nbsp; &nbsp;{id:&quot;Ullensaker Kommune&quot;, t:&quot;p&quot;},

 &nbsp; &nbsp; &nbsp; &nbsp;// OPERATOR (IKS)
 &nbsp; &nbsp; &nbsp; &nbsp;{id:&quot;Øvre Romerike Avfallsselskap IKS&quot;, t:&quot;op&quot;, l:&quot;(ØRAS)&quot;},

 &nbsp; &nbsp; &nbsp; &nbsp;// ACTIVE SITE (Main Facility)
 &nbsp; &nbsp; &nbsp; &nbsp;{id:&quot;Miljøstasjon Dal Skog&quot;, t:&quot;mottak&quot;, active:true}
 &nbsp; &nbsp;];
 &nbsp; &nbsp;
 &nbsp; &nbsp;var LINKS = [
 &nbsp; &nbsp; &nbsp; &nbsp;// Owners -&gt; Company
 &nbsp; &nbsp; &nbsp; &nbsp;[&quot;Øvre Romerike Avfallsselskap IKS&quot;, &quot;Eidsvoll Kommune&quot;],
 &nbsp; &nbsp; &nbsp; &nbsp;[&quot;Øvre Romerike Avfallsselskap IKS&quot;, &quot;Hurdal Kommune&quot;],
 &nbsp; &nbsp; &nbsp; &nbsp;[&quot;Øvre Romerike Avfallsselskap IKS&quot;, &quot;Nannestad Kommune&quot;],
 &nbsp; &nbsp; &nbsp; &nbsp;[&quot;Øvre Romerike Avfallsselskap IKS&quot;, &quot;Ullensaker Kommune&quot;],

 &nbsp; &nbsp; &nbsp; &nbsp;// Company -&gt; Site
 &nbsp; &nbsp; &nbsp; &nbsp;[&quot;Miljøstasjon Dal Skog&quot;, &quot;Øvre Romerike Avfallsselskap IKS&quot;]
 &nbsp; &nbsp;];

 &nbsp; &nbsp;var COLORS = {
 &nbsp; &nbsp; &nbsp; &nbsp;p: &quot;#000000&quot;, s: &quot;#e0e0e0&quot;, op: &quot;#3b82f6&quot;, &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp;deponi: &quot;#ff003c&quot;, pukk: &quot;#ff9500&quot;, mottak: &quot;#39ff14&quot;, gjenvinning: &quot;#39ff14&quot;
 &nbsp; &nbsp;};

 &nbsp; &nbsp;var el = document.getElementById(containerID);
 &nbsp; &nbsp;// Safety dimensions
 &nbsp; &nbsp;var W = el.offsetWidth || 800;
 &nbsp; &nbsp;var H = el.offsetHeight || 600;
 &nbsp; &nbsp;
 &nbsp; &nbsp;var svg, nodes=[], links=[], parentMap={}, childrenMap={};

 &nbsp; &nbsp;function getStrictLineage(startNode) {
 &nbsp; &nbsp; &nbsp; &nbsp;let pathNodes = new Set();
 &nbsp; &nbsp; &nbsp; &nbsp;let pathLinks = new Set();
 &nbsp; &nbsp; &nbsp; &nbsp;pathNodes.add(startNode);
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp;let curr = startNode;
 &nbsp; &nbsp; &nbsp; &nbsp;while(curr) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let parentId = parentMap[curr.id];
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(!parentId) break;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let parentNode = nodes.find(n =&gt; n.id === parentId);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(parentNode) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let link = links.find(l =&gt; (l.s === curr &amp;&amp; l.t === parentNode) || (l.t === curr &amp;&amp; l.s === parentNode));
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(link) pathLinks.add(link);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pathNodes.add(parentNode);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;curr = parentNode;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else break;
 &nbsp; &nbsp; &nbsp; &nbsp;}

 &nbsp; &nbsp; &nbsp; &nbsp;function addChildren(pNode) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let kids = childrenMap[pNode.id] || [];
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;kids.forEach(kidId =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let kNode = nodes.find(n =&gt; n.id === kidId);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(kNode) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let link = links.find(l =&gt; (l.s === kNode &amp;&amp; l.t === pNode) || (l.t === kNode &amp;&amp; l.s === pNode));
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(link) pathLinks.add(link);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pathNodes.add(kNode);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;addChildren(kNode);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp;}
 &nbsp; &nbsp; &nbsp; &nbsp;addChildren(startNode);
 &nbsp; &nbsp; &nbsp; &nbsp;return {nodes: pathNodes, links: pathLinks};
 &nbsp; &nbsp;}

 &nbsp; &nbsp;function createShape(type, isActive) {
 &nbsp; &nbsp; &nbsp; &nbsp;var ns = &quot;http://www.w3.org/2000/svg&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp;var shape;
 &nbsp; &nbsp; &nbsp; &nbsp;if (type === 'p') { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape = document.createElementNS(ns, &quot;rect&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;x&quot;, -6); shape.setAttribute(&quot;y&quot;, -6);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;width&quot;, 12); shape.setAttribute(&quot;height&quot;, 12);
 &nbsp; &nbsp; &nbsp; &nbsp;} else if (type === 's') { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape = document.createElementNS(ns, &quot;rect&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;x&quot;, -4); shape.setAttribute(&quot;y&quot;, -4);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;width&quot;, 8); shape.setAttribute(&quot;height&quot;, 8);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;stroke&quot;, &quot;#000&quot;); shape.setAttribute(&quot;stroke-width&quot;, &quot;0.5&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp;} else if (type === 'op') { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape = document.createElementNS(ns, &quot;rect&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;x&quot;, -5); shape.setAttribute(&quot;y&quot;, -5);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;width&quot;, 10); shape.setAttribute(&quot;height&quot;, 10);
 &nbsp; &nbsp; &nbsp; &nbsp;} else if (type === 'mottak') { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape = document.createElementNS(ns, &quot;polygon&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;points&quot;, &quot;0,-6 6,0 0,6 -6,0&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp;} else { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape = document.createElementNS(ns, &quot;circle&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;r&quot;, 4);
 &nbsp; &nbsp; &nbsp; &nbsp;}
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp;if(isActive &amp;&amp; type !== 'p' &amp;&amp; type !== 's') {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;transform&quot;, &quot;scale(1.5)&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp;}
 &nbsp; &nbsp; &nbsp; &nbsp;return shape;
 &nbsp; &nbsp;}

 &nbsp; &nbsp;function init() {
 &nbsp; &nbsp; &nbsp; &nbsp;if(!el) return;
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp;LINKS.forEach(pair =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let child = pair[0];
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let parent = pair[1];
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;parentMap[child] = parent;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(!childrenMap[parent]) childrenMap[parent] = [];
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;childrenMap[parent].push(child);
 &nbsp; &nbsp; &nbsp; &nbsp;});

 &nbsp; &nbsp; &nbsp; &nbsp;const resizeObserver = new ResizeObserver(entries =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (let entry of entries) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;W = entry.contentRect.width || el.offsetWidth || 800;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;H = entry.contentRect.height || el.offsetHeight || 600;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(svg) svg.setAttribute(&quot;viewBox&quot;, &quot;0 0 &quot; + W + &quot; &quot; + H);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}
 &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp;resizeObserver.observe(el);
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp;el.innerHTML = &quot;&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp;var ns = &quot;http://www.w3.org/2000/svg&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp;svg = document.createElementNS(ns, &quot;svg&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp;svg.setAttribute(&quot;viewBox&quot;, &quot;0 0 &quot; + W + &quot; &quot; + H);
 &nbsp; &nbsp; &nbsp; &nbsp;svg.style.display = &quot;block&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp;svg.style.width = &quot;100%&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp;svg.style.height = &quot;100%&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp;el.appendChild(svg);

 &nbsp; &nbsp; &nbsp; &nbsp;nodes = NODES.map(d =&gt; ({
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;id: d.id, type: d.t, label: d.l, active: d.active,
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x: W/2 + (Math.random()-0.5)*50,
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;y: H/2 + (Math.random()-0.5)*50,
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;vx: 0, vy: 0
 &nbsp; &nbsp; &nbsp; &nbsp;}));

 &nbsp; &nbsp; &nbsp; &nbsp;links = [];
 &nbsp; &nbsp; &nbsp; &nbsp;LINKS.forEach(pair =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var s = nodes.find(n=&gt;n.id===pair[0]);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var t = nodes.find(n=&gt;n.id===pair[1]);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(s &amp;&amp; t) links.push({s:s, t:t});
 &nbsp; &nbsp; &nbsp; &nbsp;});

 &nbsp; &nbsp; &nbsp; &nbsp;var linkG = document.createElementNS(ns, &quot;g&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp;svg.appendChild(linkG);
 &nbsp; &nbsp; &nbsp; &nbsp;links.forEach(l =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var line = document.createElementNS(ns, &quot;line&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line.setAttribute(&quot;stroke&quot;, &quot;#ddd&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line.setAttribute(&quot;stroke-width&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;linkG.appendChild(line);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;l.el = line;
 &nbsp; &nbsp; &nbsp; &nbsp;});

 &nbsp; &nbsp; &nbsp; &nbsp;var nodeG = document.createElementNS(ns, &quot;g&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp;svg.appendChild(nodeG);

 &nbsp; &nbsp; &nbsp; &nbsp;nodes.forEach(n =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var g = document.createElementNS(ns, &quot;g&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.style.cursor = &quot;pointer&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (n.active) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var ring = document.createElementNS(ns, &quot;circle&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ring.setAttribute(&quot;r&quot;, 18);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ring.setAttribute(&quot;fill&quot;, &quot;transparent&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ring.setAttribute(&quot;stroke&quot;, &quot;#000&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ring.setAttribute(&quot;stroke-width&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ring.setAttribute(&quot;stroke-dasharray&quot;, &quot;2,2&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var anim = document.createElementNS(ns, &quot;animateTransform&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;anim.setAttribute(&quot;attributeName&quot;, &quot;transform&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;anim.setAttribute(&quot;type&quot;, &quot;rotate&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;anim.setAttribute(&quot;from&quot;, &quot;0 0 0&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;anim.setAttribute(&quot;to&quot;, &quot;360 0 0&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;anim.setAttribute(&quot;dur&quot;, &quot;10s&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;anim.setAttribute(&quot;repeatCount&quot;, &quot;indefinite&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ring.appendChild(anim);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.appendChild(ring);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var hit = document.createElementNS(ns, &quot;circle&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hit.setAttribute(&quot;r&quot;, 25); hit.setAttribute(&quot;fill&quot;, &quot;transparent&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.appendChild(hit);

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var shape = createShape(n.type, n.active);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shape.setAttribute(&quot;fill&quot;, COLORS[n.type] || &quot;#999&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (n.active) { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape.setAttribute(&quot;stroke&quot;, &quot;#000&quot;); 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape.setAttribute(&quot;stroke-width&quot;, &quot;1.5&quot;); 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if (n.type !== 's') { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape.setAttribute(&quot;stroke&quot;, &quot;#fff&quot;); 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shape.setAttribute(&quot;stroke-width&quot;, &quot;1&quot;); 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.appendChild(shape);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.shapeEl = shape;

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var txt = document.createElementNS(ns, &quot;text&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var textContent = n.id;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(n.label) textContent += &quot; &quot; + n.label;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;txt.textContent = textContent;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;txt.setAttribute(&quot;x&quot;, 12); txt.setAttribute(&quot;y&quot;, 3);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;txt.setAttribute(&quot;fill&quot;, n.active ? &quot;#000&quot; : &quot;#999&quot;); 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; txt.style.font = n.active ? &quot;bold 10px Helvetica, Arial, sans-serif&quot; : &quot;9px Helvetica, Arial, sans-serif&quot;; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; txt.style.pointerEvents = &quot;none&quot;;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.appendChild(txt);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.tEl = txt;

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.onmouseenter = function() {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var lineage = getStrictLineage(n);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nodes.forEach(node =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.shapeEl.setAttribute(&quot;opacity&quot;, &quot;0.1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.tEl.setAttribute(&quot;opacity&quot;, &quot;0.1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;links.forEach(link =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.el.setAttribute(&quot;stroke&quot;, &quot;#eee&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.el.setAttribute(&quot;opacity&quot;, &quot;0.1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lineage.nodes.forEach(node =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.shapeEl.setAttribute(&quot;opacity&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.tEl.setAttribute(&quot;opacity&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.tEl.setAttribute(&quot;fill&quot;, &quot;#000&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lineage.links.forEach(link =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.el.setAttribute(&quot;stroke&quot;, &quot;#000&quot;); 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; link.el.setAttribute(&quot;opacity&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.shapeEl.setAttribute(&quot;transform&quot;, &quot;scale(1.3)&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.onmouseleave = function() {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nodes.forEach(node =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.shapeEl.setAttribute(&quot;opacity&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.tEl.setAttribute(&quot;opacity&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.tEl.setAttribute(&quot;fill&quot;, node.active ? &quot;#000&quot; : &quot;#999&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(!node.active) node.shapeEl.setAttribute(&quot;transform&quot;, &quot;scale(1)&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;links.forEach(link =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.el.setAttribute(&quot;stroke&quot;, &quot;#ddd&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.el.setAttribute(&quot;opacity&quot;, &quot;1&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};

 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;g.onmousedown = function(e){ e.preventDefault(); n.dragging = true; };
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nodeG.appendChild(g);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.el = g;
 &nbsp; &nbsp; &nbsp; &nbsp;});

 &nbsp; &nbsp; &nbsp; &nbsp;window.addEventListener(&quot;mousemove&quot;, function(e){
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nodes.forEach(n =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(n.dragging) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var rect = svg.getBoundingClientRect();
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.x = (e.clientX - rect.left) * (W/rect.width);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.y = (e.clientY - rect.top) * (H/rect.height);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.vx = 0; n.vy = 0;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp;window.addEventListener(&quot;mouseup&quot;, function(){ nodes.forEach(n =&gt; n.dragging = false); });

 &nbsp; &nbsp; &nbsp; &nbsp;requestAnimationFrame(tick);
 &nbsp; &nbsp;}

 &nbsp; &nbsp;function tick() {
 &nbsp; &nbsp; &nbsp; &nbsp;links.forEach(l =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var dx = l.t.x - l.s.x; var dy = l.t.y - l.s.y;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var dist = Math.sqrt(dx*dx + dy*dy) || 1;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var restLen = 60;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(l.s.active || l.t.active) restLen = 90;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var force = (dist - restLen) * 0.05;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var fx = (dx/dist)*force; var fy = (dy/dist)*force;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;l.s.vx += fx; l.s.vy += fy; l.t.vx -= fx; l.t.vy -= fy;
 &nbsp; &nbsp; &nbsp; &nbsp;});

 &nbsp; &nbsp; &nbsp; &nbsp;nodes.forEach(n =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nodes.forEach(n2 =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(n===n2) return;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var dx = n.x - n2.x; var dy = n.y - n2.y;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var dist = Math.sqrt(dx*dx + dy*dy) || 1;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(dist &lt; 100) { 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var f = (100-dist) * 0.05; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.vx += (dx/dist)*f; n.vy += (dy/dist)*f; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.vx += (W/2 - n.x) * 0.02; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n.vy += (H/2 - n.y) * 0.02;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(!n.dragging) { n.x += n.vx; n.y += n.vy; n.vx *= 0.85; n.vy *= 0.85; }
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.x = Math.max(20, Math.min(W - 40, n.x));
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n.y = Math.max(20, Math.min(H - 20, n.y));
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(n.el) n.el.setAttribute(&quot;transform&quot;, &quot;translate(&quot;+n.x+&quot;,&quot;+n.y+&quot;)&quot;);
 &nbsp; &nbsp; &nbsp; &nbsp;});

 &nbsp; &nbsp; &nbsp; &nbsp;links.forEach(l =&gt; {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(l.el) {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;l.el.setAttribute(&quot;x1&quot;, l.s.x); l.el.setAttribute(&quot;y1&quot;, l.s.y);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;l.el.setAttribute(&quot;x2&quot;, l.t.x); l.el.setAttribute(&quot;y2&quot;, l.t.y);
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}
 &nbsp; &nbsp; &nbsp; &nbsp;});
 &nbsp; &nbsp; &nbsp; &nbsp;if(document.contains(el)) requestAnimationFrame(tick);
 &nbsp; &nbsp;}
 &nbsp; &nbsp;setTimeout(init, 500);
})();
&lt;/script&gt;</pre>
</body>
</html>